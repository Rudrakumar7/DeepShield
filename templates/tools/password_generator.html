{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="mb-4">üîê Password Generator</h2>
    <div class="glass p-4" style="max-width: 600px; margin: 0 auto;">
        <div class="mt-4">
            <div class="form-group mb-3">
                <label>Name / Nickname</label>
                <input type="text" class="form-control" id="nameInput" placeholder="e.g. John">
            </div>
            <div class="form-group mb-3">
                <label>Important Year</label>
                <input type="number" class="form-control" id="yearInput" placeholder="e.g. 1990">
            </div>
            <div class="form-group mb-3">
                <label>Safety Keyword</label>
                <input type="text" class="form-control" id="keywordInput" placeholder="e.g. Pizza">
            </div>

            <div class="form-group" style="display: flex; gap: 1rem; align-items: flex-end;">
                <button class="btn-primary" onclick="generatePassword()">Generate Personalized Password</button>
                <button class="btn-secondary" onclick="copyPassword()">Copy</button>
            </div>
            <input type="text" class="form-control text-center" id="pwdOutput" readonly
                style="font-size: 1.2rem; margin-top: 1rem; color: var(--primary-accent);">
        </div>
        <div class="mt-4 text-center">
            <a href="{{ url_for('tools') }}" class="text-secondary">‚Üê Back to Tools</a>
        </div>
    </div>
</div>

<script>
    async function generatePassword() {
        const name = document.getElementById('nameInput').value;
        const year = document.getElementById('yearInput').value;
        const keyword = document.getElementById('keywordInput').value;

        try {
            const response = await fetch('/tools/password-generator', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ name, year, keyword }),
            });

            if (!response.ok) throw new Error('Failed to generate');

            const data = await response.json();
            document.getElementById('pwdOutput').value = data.password;

        } catch (error) {
            console.error(error);
            alert("Error generating password");
        }
    }

    function copyPassword() {
        const pwd = document.getElementById('pwdOutput');
        pwd.select();
        document.execCommand("copy");
        alert("Password copied!");
    }
</script>
{% endblock %}